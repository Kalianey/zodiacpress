!function(e){function t(t,a){e.ajax({url:"//api.geonames.org/timezoneJSON",dataType:"jsonp",data:{lat:t,lng:a,username:zp_ajax_object.geonames_user},success:function(t){e("<input>").attr({type:"hidden",id:"geo_timezone_id",name:"geo_timezone_id",value:t.timezoneId}).appendTo("#zp-timezone-id")}})}e(function(){e("#city").autocomplete({source:function(t,a){e.ajax({url:"//api.geonames.org/searchJSON",dataType:"jsonp",data:{featureClass:"P",style:"full",maxRows:12,name_startsWith:t.term,username:zp_ajax_object.geonames_user,lang:zp_ajax_object.lang},success:function(t){a(e.map(t.geonames,function(e){return{label:e.name+(e.adminName1?", "+e.adminName1:"")+", "+e.countryName,value:e.name,lngdeci:e.lng,latdeci:e.lat}}))}})},minLength:2,select:function(a,r){e(".ui-state-error").hide(),e("#citylabel").text(zp_ajax_object.selected),e("#place").val(r.item.label),e("#zp-lat-label").text(zp_ajax_object.lat),e("#zp-long-label").text(zp_ajax_object["long"]),e("#zp-coordinates").show(),e("#zp_lat_decimal").val(r.item.latdeci),e("#zp_long_decimal").val(r.item.lngdeci),e("#zp-offset-wrap").hide(),e("#zp-fetch-birthreport").hide(),e("#zp-form-tip").hide(),e("#zp-fetch-offset").show(),t(r.item.latdeci,r.item.lngdeci)}}),e("#zp-fetch-offset").click(function(t){var a={action:"zp_tz_offset",post_data:e("#zp-ajax-birth-data :input").serialize()};return e.ajax({url:zp_ajax_object.ajaxurl,type:"POST",data:a,dataType:"json",success:function(t){if(t.error){e(".ui-state-error").hide();var a=e("<span />");a.attr("class","ui-state-error"),a.text(t.error),e("#zp-ajax-birth-data").append(a)}else e.trim(t.offset_geo)&&"false"!=e.trim(t.offset_geo)&&(e(".ui-state-error").hide(),e("#zp-offset-wrap").show(),e("#zp-offset-label").text(zp_ajax_object.utc+" "),e("#zp_offset_geo").val(t.offset_geo),e("#zp-form-tip").show(),e("#zp-fetch-offset").hide(),e("#zp-fetch-birthreport").show())}}),!1}),e("#zp-fetch-birthreport").click(function(){return e.ajax({url:zp_ajax_object.ajaxurl,type:"POST",data:e("#zp-birthreport-form").serialize(),dataType:"json",success:function(t){if(t.error){e(".ui-state-error").hide();var a=e("<span />");a.attr("class","ui-state-error"),a.text(t.error),e("#zp-offset-wrap").after(a)}else if(e.trim(t.report)&&"false"!=e.trim(t.report)){e(".ui-state-error").hide(),e("#zp-report-wrap").show(),e("#zp-report-content").append(t.report),e("#zp-form-wrap").hide();var r=e("#zp-report-wrap").offset().top;e("html,body").animate({scrollTop:r},"slow")}}}),!1}),e("#month, #day, #year").on("change",function(){var t=!this.options[this.selectedIndex].defaultSelected;t&&(e("#zp-offset-wrap").hide(),e("#zp-fetch-birthreport").hide(),e("#zp-form-tip").hide(),e("#zp-fetch-offset").show())})})}(jQuery);